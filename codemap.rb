# typed: false
# frozen_string_literal: true

# This file was generated by GoReleaser. DO NOT EDIT.
class Codemap < Formula
  desc "Generate a brain map of your codebase for LLM context"
  homepage "https://github.com/JordanCoin/codemap"
  version "3.1.1"
  license "MIT"

  depends_on "ast-grep"

  on_macos do
    if Hardware::CPU.intel?
      url "https://github.com/JordanCoin/codemap/releases/download/v3.1.1/codemap_3.1.1_darwin_amd64.tar.gz"
      sha256 "57438f97e4a77db609c01230f0fb486dd3025b3bc2c0d6a9af109826ebd0537d"

      def install
        bin.install "codemap"
        (pkgshare/"sg-rules").install Dir["sg-rules/*.yml"] if Dir.exist?("sg-rules")
      end
    end
    if Hardware::CPU.arm?
      url "https://github.com/JordanCoin/codemap/releases/download/v3.1.1/codemap_3.1.1_darwin_arm64.tar.gz"
      sha256 "977596b7b8d090d195d3b528433c8c65cd81a0e7d76240e8db8030b565589c92"

      def install
        bin.install "codemap"
        (pkgshare/"sg-rules").install Dir["sg-rules/*.yml"] if Dir.exist?("sg-rules")
      end
    end
  end

  on_linux do
    if Hardware::CPU.intel? && Hardware::CPU.is_64_bit?
      url "https://github.com/JordanCoin/codemap/releases/download/v3.1.1/codemap_3.1.1_linux_amd64.tar.gz"
      sha256 "cc08e724444a0c941bfa77f0d78cee90c36a50e271e88f879c7b8c68bf3a78cb"
      def install
        bin.install "codemap"
        (pkgshare/"sg-rules").install Dir["sg-rules/*.yml"] if Dir.exist?("sg-rules")
      end
    end
    if Hardware::CPU.arm? && Hardware::CPU.is_64_bit?
      url "https://github.com/JordanCoin/codemap/releases/download/v3.1.1/codemap_3.1.1_linux_arm64.tar.gz"
      sha256 "02ae6fe04f428897f0b4179845193432257e4a7f91673ca6268f83ba39046ed8"
      def install
        bin.install "codemap"
        (pkgshare/"sg-rules").install Dir["sg-rules/*.yml"] if Dir.exist?("sg-rules")
      end
    end
  end

  def caveats
    <<~EOS
      The --deps mode uses ast-grep for code analysis.
    EOS
  end

  test do
    system "#{bin}/codemap", "--help"
  end
end
