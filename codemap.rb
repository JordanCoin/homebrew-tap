# typed: false
# frozen_string_literal: true

# This file was generated by GoReleaser. DO NOT EDIT.
class Codemap < Formula
  desc "Generate a brain map of your codebase for LLM context"
  homepage "https://github.com/JordanCoin/codemap"
  version "3.1.0"
  license "MIT"

  depends_on "ast-grep"

  on_macos do
    if Hardware::CPU.intel?
      url "https://github.com/JordanCoin/codemap/releases/download/v3.1.0/codemap_3.1.0_darwin_amd64.tar.gz"
      sha256 "6ff657f1d944cff0c86ec398141a5bb2c585b927c2d14b5f43feb20f107c1743"

      def install
        bin.install "codemap"
        (pkgshare/"sg-rules").install Dir["sg-rules/*.yml"] if Dir.exist?("sg-rules")
      end
    end
    if Hardware::CPU.arm?
      url "https://github.com/JordanCoin/codemap/releases/download/v3.1.0/codemap_3.1.0_darwin_arm64.tar.gz"
      sha256 "76a564a970aab526e7eb3ea1a4e9d4afab2feb006bf1a1cb58970fc032b7a56c"

      def install
        bin.install "codemap"
        (pkgshare/"sg-rules").install Dir["sg-rules/*.yml"] if Dir.exist?("sg-rules")
      end
    end
  end

  on_linux do
    if Hardware::CPU.intel? && Hardware::CPU.is_64_bit?
      url "https://github.com/JordanCoin/codemap/releases/download/v3.1.0/codemap_3.1.0_linux_amd64.tar.gz"
      sha256 "e9c6b14ad6d691ce66075ce77bc0bbea80cec6a1e1f4256e8d18f0e1e2c7cb29"
      def install
        bin.install "codemap"
        (pkgshare/"sg-rules").install Dir["sg-rules/*.yml"] if Dir.exist?("sg-rules")
      end
    end
    if Hardware::CPU.arm? && Hardware::CPU.is_64_bit?
      url "https://github.com/JordanCoin/codemap/releases/download/v3.1.0/codemap_3.1.0_linux_arm64.tar.gz"
      sha256 "4c0c288cd762ede5480e72fda9b67a9ef08a9971bbd7ce9c56b8aeb98b4b3c05"
      def install
        bin.install "codemap"
        (pkgshare/"sg-rules").install Dir["sg-rules/*.yml"] if Dir.exist?("sg-rules")
      end
    end
  end

  def caveats
    <<~EOS
      The --deps mode uses ast-grep for code analysis.
    EOS
  end

  test do
    system "#{bin}/codemap", "--help"
  end
end
